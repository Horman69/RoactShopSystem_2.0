--!strict
-- src/services/SimplePlatformService.luau
-- –ü—Ä–æ—Å—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
-- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –±–µ–∑ –ø–µ—Ä–µ—É—Å–ª–æ–∂–Ω–µ–Ω–∏—è

local UserInputService = game:GetService("UserInputService")
local GuiService = game:GetService("GuiService")

-- –ü—Ä–æ—Å—Ç—ã–µ —Ç–∏–ø—ã
export type AdaptiveConfig = {
	-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
	abilityButtonSize: UDim2,
	shopButtonSize: UDim2,
	walletSize: UDim2,
	
	-- –†–∞–∑–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–∞
	headerTextSize: number,
	bodyTextSize: number,
	buttonTextSize: number,
	
	-- –û—Ç—Å—Ç—É–ø—ã
	padding: number,
	spacing: number,
	
	-- –ü—Ä–æ—á–µ–µ
	cornerRadius: number,
	strokeThickness: number,
}

local SimplePlatformService = {}
SimplePlatformService.__index = SimplePlatformService

-- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
function SimplePlatformService.new()
	local self = setmetatable({}, SimplePlatformService)
	return self
end

-- –ü–†–û–°–¢–û–ï –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
function SimplePlatformService:isMobile(): boolean
	-- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å touch, –Ω–µ—Ç –º—ã—à–∏
	return UserInputService.TouchEnabled and not UserInputService.MouseEnabled
end

-- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞–Ω—à–µ—Ç–∞
function SimplePlatformService:isTablet(): boolean
	if not UserInputService.TouchEnabled then
		return false
	end
	
	-- –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –±–æ–ª—å—à–µ —á–µ–º —É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
	local viewportSize = workspace.CurrentCamera.ViewportSize
	local minDimension = math.min(viewportSize.X, viewportSize.Y)
	
	-- –ü–ª–∞–Ω—à–µ—Ç –µ—Å–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –±–æ–ª—å—à–µ 600px
	return minDimension > 600 and UserInputService.TouchEnabled
end

-- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ—Å–∫—Ç–æ–ø–∞
function SimplePlatformService:isDesktop(): boolean
	return not self:isMobile() and not self:isTablet()
end

-- –ü–†–û–°–¢–ê–Ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ - –∫–∞–∫ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
function SimplePlatformService:getConfig(): AdaptiveConfig
	if self:isMobile() then
		-- üì± –ú–û–ë–ò–õ–¨–ù–´–ï –¢–ï–õ–ï–§–û–ù–´ - –æ—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
		return {
			-- –†–∞–∑–º–µ—Ä—ã –∫–Ω–æ–ø–æ–∫ (–æ—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
			abilityButtonSize = UDim2.new(0, 50, 0, 50),    -- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ 50x50 –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
			shopButtonSize = UDim2.new(0, 100, 0, 36),      -- –ú–µ–Ω—å—à–∏–π –º–∞–≥–∞–∑–∏–Ω 100x36
			walletSize = UDim2.new(0, 160, 0, 32),          -- –û—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –∫–æ—à–µ–ª—ë–∫
			
			-- –†–∞–∑–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–∞ (–∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
			headerTextSize = 18,        -- –ú–µ–Ω—å—à–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
			bodyTextSize = 14,          -- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç
			buttonTextSize = 14,        -- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö
			
			-- –û—Ç—Å—Ç—É–ø—ã (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ)
			padding = 8,                -- –ú–µ–Ω—å—à–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã
			spacing = 6,                -- –ú–µ–Ω—å—à–µ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
			
			-- –°—Ç–∏–ª—å
			cornerRadius = 6,           -- –ú–µ–Ω—å—à–µ —Å–∫—Ä—É–≥–ª–µ–Ω–∏–µ
			strokeThickness = 1,        -- –¢–æ–Ω—å—à–µ –æ–±–≤–æ–¥–∫–∞
		}
		
	elseif self:isTablet() then
		-- üì± –ü–õ–ê–ù–®–ï–¢–´ - –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ
		return {
			abilityButtonSize = UDim2.new(0, 80, 0, 80),    -- –ß—É—Ç—å –±–æ–ª—å—à–µ –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤
			shopButtonSize = UDim2.new(0, 140, 0, 55),
			walletSize = UDim2.new(0, 240, 0, 45),
			
			headerTextSize = 26,
			bodyTextSize = 18,
			buttonTextSize = 20,
			
			padding = 16,
			spacing = 10,
			
			cornerRadius = 10,
			strokeThickness = 2,
		}
		
	else
		-- üñ•Ô∏è –î–ï–°–ö–¢–û–ü - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
		return {
			abilityButtonSize = UDim2.new(0, 64, 0, 64),    -- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
			shopButtonSize = UDim2.new(0, 140, 0, 54),
			walletSize = UDim2.new(0, 220, 0, 50),
			
			headerTextSize = 24,
			bodyTextSize = 18,
			buttonTextSize = 18,
			
			padding = 10,
			spacing = 8,
			
			cornerRadius = 12,
			strokeThickness = 3,
		}
	end
end

-- –ü–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞
function SimplePlatformService:getScreenSize(): Vector2
	return workspace.CurrentCamera.ViewportSize
end

-- –ü–æ–ª—É—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã (–¥–ª—è notch –∏ —Ç.–¥.)
function SimplePlatformService:getSafeAreaInsets()
	local guiInset = GuiService:GetGuiInset()
	return {
		Top = guiInset.Y,
		Bottom = 0,
		Left = guiInset.X,
		Right = 0,
	}
end

-- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º API
function SimplePlatformService:getMobileUIConfig()
	local config = self:getConfig()
	
	-- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
	return {
		buttonSize = config.shopButtonSize,
		abilityButtonSize = config.abilityButtonSize,
		shopCardHeight = 80,
		textSize = config.buttonTextSize,
		iconSize = 32,
		padding = config.padding,
		margin = config.spacing,
		bottomSafeArea = 20,
		topSafeArea = 20,
		touchPadding = 8,
		minimumTouchSize = 44,
	}
end

function SimplePlatformService:getAdaptiveSizes()
	local config = self:getConfig()
	return {
		abilityButton = {
			X = config.abilityButtonSize.X.Offset,
			Y = config.abilityButtonSize.Y.Offset
		},
		shopButton = {
			X = config.shopButtonSize.X.Offset,
			Y = config.shopButtonSize.Y.Offset
		},
		fontSize = config.buttonTextSize,
		padding = config.padding,
	}
end

function SimplePlatformService:getScaleFactor(): number
	-- –ü—Ä–æ—Å—Ç–æ–π —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—à—Ç–∞–± - –Ω–∏–∫–∞–∫–∏—Ö —Å–ª–æ–∂–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤
	if self:isMobile() then
		return 1.0  -- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—à—Ç–∞–± –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
	elseif self:isTablet() then
		return 1.1  -- –ß—É—Ç—å –±–æ–ª—å—à–µ –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤
	else
		return 1.0  -- –û–±—ã—á–Ω—ã–π –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞
	end
end

function SimplePlatformService:isTouchEnabled(): boolean
	return UserInputService.TouchEnabled
end

return SimplePlatformService
