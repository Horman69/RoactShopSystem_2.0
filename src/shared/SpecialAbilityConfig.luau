--!strict
-- src/shared/SpecialAbilityConfig.luau
-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ—Å–æ–±—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π - –ø—Ä–µ–º–∏—É–º –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –±—É–¥—É—â–µ–≥–æ
-- –≠—Ç–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–∫—É–ø–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Types = require(ReplicatedStorage:WaitForChild("shared"):WaitForChild("Types"))

type Ability = Types.Ability
type AbilityList = Types.AbilityList

-- ===== –û–°–û–ë–´–ï –°–ü–û–°–û–ë–ù–û–°–¢–ò =====

local SPECIAL_ABILITIES: AbilityList = {
	-- üí™ –°–ü–û–°–û–ë–ù–û–°–¢–¨ –°–ò–õ–´ - –ø—Ä–µ–º–∏—É–º
	{
		id = "strength_boost",
		name = "üí™ –°–∏–ª–∞",
		description = "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É—Ä–æ–Ω –≤ 2 —Ä–∞–∑–∞ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥",
		category = "Combat",
		baseDuration = 10,
		cooldown = 45,
		price = 200, -- –¥–æ—Ä–æ–∂–µ –æ–±—ã—á–Ω—ã—Ö
		effects = {
			{
				type = "Multiply",
				value = 2.0,
				target = "Damage"
			}
		},
		icon = "üí™",
		isStackable = false,
		hotkey = "T",
		visualEffect = "strength_aura",
		-- –û—Å–æ–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
		isSpecial = true, -- —Ñ–ª–∞–≥ –æ—Å–æ–±–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
		requiresUnlock = true, -- —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
		unlockLevel = 10, -- –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
	},
	
	-- üí® –°–ü–û–°–û–ë–ù–û–°–¢–¨ –ù–ï–í–ò–î–ò–ú–û–°–¢–ò - –ø—Ä–µ–º–∏—É–º
	{
		id = "invisibility",
		name = "üí® –ù–µ–≤–∏–¥–∏–º–æ—Å—Ç—å",
		description = "–î–µ–ª–∞–µ—Ç –∏–≥—Ä–æ–∫–∞ –Ω–µ–≤–∏–¥–∏–º—ã–º –Ω–∞ 8 —Å–µ–∫—É–Ω–¥",
		category = "Utility",
		baseDuration = 8,
		cooldown = 60,
		price = 300, -- –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ
		effects = {
			{
				type = "Set",
				value = 0.1, -- –ø–æ—á—Ç–∏ –Ω–µ–≤–∏–¥–∏–º
				target = "Transparency"
			}
		},
		icon = "üí®",
		isStackable = false,
		hotkey = "F",
		visualEffect = "fade_out",
		-- –û—Å–æ–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
		isSpecial = true,
		requiresUnlock = true,
		unlockLevel = 15,
		unlockRequirements = {"strength_boost"}, -- –Ω—É–∂–Ω–∞ —Å–∏–ª–∞
	},
	
	-- üî• –û–ì–ù–ï–ù–ù–ê–Ø –ê–£–†–ê - –ø—Ä–µ–º–∏—É–º
	{
		id = "fire_aura",
		name = "üî• –û–≥–Ω–µ–Ω–Ω–∞—è –∞—É—Ä–∞",
		description = "–ù–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω –≤—Å–µ–º –≤—Ä–∞–≥–∞–º —Ä—è–¥–æ–º –Ω–∞ 12 —Å–µ–∫—É–Ω–¥",
		category = "Combat",
		baseDuration = 12,
		cooldown = 50,
		price = 250,
		effects = {
			{
				type = "Add",
				value = 20,
				target = "AreaDamage"
			}
		},
		icon = "üî•",
		isStackable = false,
		hotkey = "G",
		visualEffect = "fire_aura",
		-- –û—Å–æ–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
		isSpecial = true,
		requiresUnlock = true,
		unlockLevel = 12,
	},
}

-- ===== –§–£–ù–ö–¶–ò–ò –î–û–°–¢–£–ü–ê =====

local SpecialAbilityConfig = {}

-- –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Å–æ–±—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
function SpecialAbilityConfig.getAllSpecialAbilities(): AbilityList
	return SPECIAL_ABILITIES
end

-- –ü–æ–ª—É—á–∏—Ç—å –æ—Å–æ–±—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–æ ID
function SpecialAbilityConfig.getSpecialAbilityById(abilityId: string): Ability?
	for _, ability in ipairs(SPECIAL_ABILITIES) do
		if ability.id == abilityId then
			return ability
		end
	end
	return nil
end

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ—Å–æ–±–æ–π
function SpecialAbilityConfig.isSpecialAbility(abilityId: string): boolean
	return SpecialAbilityConfig.getSpecialAbilityById(abilityId) ~= nil
end

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
function SpecialAbilityConfig.checkUnlockRequirements(ability: Ability, playerLevel: number, ownedAbilities: {[string]: boolean}): boolean
	if not ability.isSpecial then
		return true
	end
	
	-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
	if ability.unlockLevel and playerLevel < ability.unlockLevel then
		return false
	end
	
	-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç—Ä–µ–±—É–µ–º—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
	if ability.unlockRequirements then
		for _, requiredId in ipairs(ability.unlockRequirements) do
			if not ownedAbilities[requiredId] then
				return false
			end
		end
	end
	
	return true
end

print("‚úÖ SpecialAbilityConfig: –ó–∞–≥—Ä—É–∂–µ–Ω–æ", #SPECIAL_ABILITIES, "–æ—Å–æ–±—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π")

return SpecialAbilityConfig
